Craigspin's
===========

<a href='javascript:(function(){var a=$("body").html();var b=$("<form/>",{id:"qForm"});var c=$("<input/>",{id:"q"}).css({cssFloat:"left",width:183,border:"1px solid",lineHeight:1.3,boxShadow:"0 1px #fff, inset 0 1px rgba(34,25,25,0.05)","-moz-box-shadow":"0 1px #fff, inset 0 1px rgba(34,25,25,0.05)","-webkit-box-shadow":"0 1px #fff, inset 0 1px rgba(34,25,25,0.05)",fontSize:13,borderColor:"#C2C0C0 #CCCACA #D1CFCF",padding:5,backgroundColor:"#FAF7F7"});var d=$("<a/>",{id:"qBtn",href:"#"}).css({cssFloat:"left",marginLeft:-1,padding:"7px 7px 2px",minHeight:17,border:"1px solid",boxShadow:"0 1px rgba(255,255,255,0.9), inset 0 0 2px rgba(255,255,255,0.75)","-moz-box-shadow":"0 1px rgba(255,255,255,0.9), inset 0 0 2px rgba(255,255,255,0.75)","-webkit-box-shadow":"0 1px rgba(255,255,255,0.9), inset 0 0 2px rgba(255,255,255,0.75)",borderColor:"#C2C0C0 #CCCACA #D1CFCF"}).append($("<img/>",{src:"http://passets-cdn.pinterest.com/images/search.gif"}));var e=$("<div/>",{id:"qWr"}).css({cssFloat:"left",margin:"8px 0 0",paddingLeft:15}).append(b.append(c).append(d));var f=$("<div/>",{id:"logo"}).css({position:"absolute",marginLeft:-50,left:"50%",top:7}).append($("<span/>").css({color:"#00E",fontFamily:"serif",fontSize:31}).html("craigs")).append($("<img/>",{src:"http://passets-cdn.pinterest.com/images/LogoRed.png"}));var g=$("<div/>",{id:"nav"}).css({position:"fixed",height:44,top:0,left:0,width:"100%",backgroundColor:"#FAF7F7",boxShadow:"inset 0 1px #fff, 0 1px 3px rgba(34,25,25,0.4)",zIndex:103,"-webkit-box-shadow":"inset 0 1px #fff, 0 1px 3px rgba(34,25,25,0.4)","-moz-box-shadow":"inset 0 1px #fff, 0 1px 2px rgba(34,25,25,0.4)"}).append(e).append(f);$("body").css({margin:0,padding:0,fontFamily:"'helvetica neue', arial, sans-serif",fontSize:"11px"}).html($("<div/>",{id:"wr",style:"padding:60px 0 0; background-color:#eee; width:100%;"})).append($("<div/>",{id:"parser"}).css({display:"none"})).append(g);$("#q").focus(function(){$(this).css({backgroundColor:"#fff"})}).blur(function(){$(this).css({backgroundColor:"#FAF7F7"})});var h=function(){try{var a=$("#q").val();for(var b=0;b<l;b++)n[b].html("");r=0;t=a;v(a,0);return false}catch(c){console.log(c);return false}};b.submit(h);d.click(h);var i=222;var j=192;var k=15;var l=Math.floor($(window).width()/i);var m=($(window).width()-l*(i+k))/2;var n=[];for(var o=0;o<l;o++){var p=$("<div/>").css({width:i,cssFloat:"left",marginLeft:15});if(o==0)p.css({marginLeft:m});n.push(p);$("#wr").append(p)}$("#wr").append($("<div/>").css({clear:"both",cssFloat:"none"}));var q=window.location.href;var r=0;var s=/query=(.*?)(&|$)/;var t=(window.location.search.match(s)||[])[1];var u=function(){x=true;v(t,++r)};var v=function(a,b){console.log("loadPage: "+a);var c=q.match(s)?q.replace(s,"query="+a+"&"):q.match(/\?/)?q+"&query="+a:q+"?query="+a;$.get(c+"&s="+b*100,function(a){if(!y(a))w=true;x=false})};var w=false;var x=false;$(window).scroll(function(){if(!x&&!w&&$(window).scrollTop()+$(window).height()>$("#wr").height()-$(window).height()){u()}});var y=function(a){console.log("parsing!");var b=[];$("#parser").html(a).find("span.i").add("span.ih").each(function(){id=this.id.match(/images:(.*?)$/);if(!id)return;var a=$(this).parents("p").find("a");b.push({src:"http://images.craigslist.org/"+id[1],href:a[0].href,title:a[0].innerHTML,section:a[1].innerHTML,sectionHref:a[1].href,price:($(this).parents("p").html().match(/(\$.*?)</)||[])[1]})});for(var c=0;c<b.length;c++){var d=b[c];var e=$("<div/>",{style:"padding:15px 15px 0; margin: 0 0 15px; background-color:#fff; "+"-moz-box-shadow: 0 1px 2px rgba(34,25,25,0.4); -webkit-box-shadow: 0 1px 3px rgba(34,25,25,0.4); box-shadow: 0 1px 3px rgba(34,25,25,0.4);"}).append($("<a/>",{href:d.href,target:"_blank"}).append($("<img/>",{src:d.src,style:"width:"+j+"px"}))).append($("<div/>").css({margin:"10px 0"}).html($("<a/>",{href:d.href,target:"_blank"}).css({color:"#000",textDecoration:"none"}).html("<b>"+(d.price||"")+"</b>"+" "+d.title.substr(0,20)))).append($("<div/>").css({padding:10,margin:"0 -15px",backgroundColor:"#eee"}).html($("<a/>",{href:d.sectionHref,target:"_blank"}).css({color:"#666",textDecoration:"none"}).html(d.section)));var f=n[0];for(var g=0;g<l;g++)if(n[g].height()<f.height())f=n[g];f.append(e)}return b.length>0};y(a)})()'>
Bookmarklet
</a>

Run from Craigslist url ie: 

http://losangeles.craigslist.org/sss/

