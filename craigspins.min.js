(function(){var g=Math.floor($(window).width()/237);$(window).resize(function(){$("body").css({paddingLeft:($(window).width()-237*g)/2})});var q=$("body").html(),d=$("<form/>",{id:"qForm"}),c=$("<input/>",{id:"q"}).css({cssFloat:"left",width:183,border:"1px solid",lineHeight:1.3,boxShadow:"0 1px #fff, inset 0 1px rgba(34,25,25,0.05)","-moz-box-shadow":"0 1px #fff, inset 0 1px rgba(34,25,25,0.05)","-webkit-box-shadow":"0 1px #fff, inset 0 1px rgba(34,25,25,0.05)",fontSize:13,borderColor:"#C2C0C0 #CCCACA #D1CFCF", padding:5,backgroundColor:"#FAF7F7",margin:0}),f=$("<a/>",{id:"qBtn",href:"#"}).css({cssFloat:"left",marginLeft:-1,padding:"7px 7px 2px",minHeight:17,border:"1px solid",boxShadow:"0 1px rgba(255,255,255,0.9), inset 0 0 2px rgba(255,255,255,0.75)","-moz-box-shadow":"0 1px rgba(255,255,255,0.9), inset 0 0 2px rgba(255,255,255,0.75)","-webkit-box-shadow":"0 1px rgba(255,255,255,0.9), inset 0 0 2px rgba(255,255,255,0.75)",borderColor:"#C2C0C0 #CCCACA #D1CFCF"}).append($("<img/>",{src:"http://passets-cdn.pinterest.com/images/search.gif"})), c=$("<div/>",{id:"qWr"}).css({cssFloat:"left",margin:"8px 0 0",paddingLeft:15}).append(d.append(c).append(f)),r=$("<div/>",{id:"logo"}).css({position:"absolute",marginLeft:-50,left:"50%",top:7}).append($("<img/>",{src:"http://lemurheavy.com/images/craigspin/logo.png"})),c=$("<div/>",{id:"nav"}).css({position:"fixed",height:44,top:0,left:0,width:"100%",backgroundColor:"#FAF7F7",boxShadow:"inset 0 1px #fff, 0 1px 3px rgba(34,25,25,0.4)",zIndex:103,"-webkit-box-shadow":"inset 0 1px #fff, 0 1px 3px rgba(34,25,25,0.4)", "-moz-box-shadow":"inset 0 1px #fff, 0 1px 2px rgba(34,25,25,0.4)"}).append(c).append(r);$("html").css({background:'url("http://lemurheavy.com/images/craigspin/paper.jpg")'});$("body").css({margin:0,fontFamily:"'helvetica neue', arial, sans-serif",fontSize:"11px",background:"transparent"}).html($("<div/>",{id:"wr",style:"padding:60px 0 0; width:100%;"})).append($("<div/>",{id:"parser"}).css({display:"none"})).append(c);$("#q").focus(function(){$(this).css({backgroundColor:"#fff"})}).blur(function(){$(this).css({backgroundColor:"#FAF7F7"})}); c=function(){try{for(var a=$("#q").val(),e=0;e<g;e++)h[e].html("");l=0;m=a;n(a,0);return!1}catch(b){return console.log(b),!1}};d.submit(c);f.click(c);$("body").css({paddingLeft:($(window).width()-237*g)/2});for(var h=[],d=0;d<g;d++)f=$("<div/>").css({width:222,cssFloat:"left",marginLeft:15}),0==d&&f.css({marginLeft:0}),h.push(f),$("#wr").append(f);$("#wr").append($("<div/>").css({clear:"both",cssFloat:"none"}));var i=window.location.href,l=0,j=/query=(.*?)(&|$)/,m=(window.location.search.match(j)|| [])[1],n=function(a,e){console.log("loadPage: "+a);var b=i.match(j)?i.replace(j,"query="+a+"&"):i.match(/\?/)?i+"&query="+a:i+"?query="+a;$.get(b+"&s="+100*e,function(a){o(a)||(p=!0);k=!1})},p=!1,k=!1;$(window).scroll(function(){!k&&(!p&&$(window).scrollTop()+$(window).height()>$("#wr").height()-$(window).height())&&(k=!0,n(m,++l))});var o=function(a){console.log("parsing!");var e=[];$("#parser").html(a).find("span.i").add("span.ih").each(function(){if(id=this.id.match(/images:(.*?)$/)){var a=$(this).parents("p").find("a"); e.push({src:"http://images.craigslist.org/"+id[1],href:a[0].href,title:a[0].innerHTML,section:a[1].innerHTML,sectionHref:a[1].href,price:($(this).parents("p").html().match(/(\$.*?)</)||[])[1]})}});for(a=0;a<e.length;a++){for(var b=e[a],b=$("<div/>",{style:"padding:15px 15px 0; margin: 0 0 15px; overflow: hidden; background-color:#fff; -moz-box-shadow: 0 1px 2px rgba(34,25,25,0.4); -webkit-box-shadow: 0 1px 3px rgba(34,25,25,0.4); box-shadow: 0 1px 3px rgba(34,25,25,0.4);"}).append($("<a/>",{href:b.href, target:"_blank"}).append($("<img/>",{src:b.src,style:"width:192px"}))).append($("<div/>").css({margin:"10px 0"}).html($("<a/>",{href:b.href,target:"_blank"}).css({color:"#000",textDecoration:"none"}).html("<b>"+(b.price||"")+"</b> "+b.title.substr(0,20)))).append($("<div/>").css({padding:10,margin:"0 -15px",backgroundColor:"#eee"}).html($("<a/>",{href:b.sectionHref,target:"_blank"}).css({color:"#8C7E7E",fontWeight:"bold",textTransform:"capitalize",textDecoration:"none"}).html(b.section))),c=h[0], d=0;d<g;d++)h[d].height()<c.height()&&(c=h[d]);c.append(b)}return 0<e.length};o(q)})();